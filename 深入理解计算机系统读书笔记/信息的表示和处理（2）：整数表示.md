# 信息的表示和处理（2）：整数表示

精确定义如何编码和操作整数的数学术语：

![整数数据和算术术语表](https://ws3.sinaimg.cn/large/006tNc79gy1fzgzzxgwbqj30go0eujxk.jpg)

## 1.1 整数数据类型

![32位程序上C语言整型数据类型的取值范围](https://ws2.sinaimg.cn/large/006tNc79gy1fzh07e079dj30ia0ain3h.jpg)

![64位程序上C语言整型数据类型的取值范围](https://ws1.sinaimg.cn/large/006tNc79gy1fzh08bhu1oj30i20ae0yl.jpg)

- 唯一一个与机器相关的类型是long，其他类型的取值范围在32位机器和64位机器都一样。
- 所有类型的取值范围都是不对称的，负数范围比整数范围大1。

![C语言标准中整型数据类型必须至少保证的取值范围](https://ws3.sinaimg.cn/large/006tNc79gy1fzh0d5bl4nj30hy0b0dm1.jpg)

- C/C++都支持有符号数和无符号数，默认是有符号数。Java只支持有符号数。

## 1.2 无符号数的编码

- 无符号数编码的定义

  对向量$\vec { x } = \left[ \begin{array} { l l l l l } { x _ { w - 1 } , } & { x _ { w - 2 } , } & { \cdots , } & { x _ { 0 } } \end{array} \right]$ , 

  ​		$$B 2 U _ { w } ( \vec { x } ) \doteq \sum _ { i = 0 } ^ { w - 1 } x _ { i } 2 ^ { i }$$

  也就是说，一个无符号整数，等于第i位的比特值乘$2 ^ i$ , 再将各项相加，即得整数值。

- 函数$B2U_w$ 的取值范围是，[0, $2^\omega$ - 1]。每个介于这个区间的数都有唯一一个$\omega$ 位的值编码。反过来，每个处于这个区间的位模式，都有一个大小在这个区间的整数与之对应。因此，$B2U_w$ 是一个双射。

## 1.3 补码编码

- 补码是有符号数的表示方式。字的最高有效位解释为负权。

  ![补码的定义](https://ws3.sinaimg.cn/large/006tNc79gy1fzh1x4nnyjj30mu03swff.jpg)

  - 最高有效位$x_{\omega-1}$ 称为符号位，权重是$-2^{\omega-1}$ 。是无符号表示中权重的负数。
  - 符号位被设置为1时，值为负，设置为0时，值为非负。

- $\omega$ 位补码，能表示的最小值是[10...0]，其整数值为$T M i n _ { w } \doteq - 2 ^ { w - 1 }$ 。最大值为[01....1]，其整数值为$\operatorname { TMax } _ { w } \doteq \sum _ { i = 0 } ^ { w - 2 } 2 ^ { i } = 2 ^ { w - 1 } - 1$ 。（实际上，按照上面的定义公式，将最小值和最大值的比特位代入公式，也可得出最小值和最大值的值）。

- 在取值范围内的每个补码都有一个唯一的$\omega$ 位的补码。和无符号数一样，补码编码的函数$B2T_\omega$ 也是一个双射。

### 几个重要位模式示意图

![重要数字取值范围图表](https://ws2.sinaimg.cn/large/006tNc79gy1fzh29ah8pfj30ny098dn2.jpg)

- 补码范围不对称，$| \operatorname { TMin } | = | \operatorname { TMax } | + 1$ ,即TMin没有与之对应的正数。因为符号位设置为1 的数表示负数，而符号位为0的数表示非负数，两者各占一半。但由于全0是非负数，所以能表示的正数比负数少一个。
- 最大的无符号数值刚好比补码的最大值的两倍多一。$U M a x _ { w } = 2 T M a x _ { w } + 1$ 
- 补码表示中所有表示负数的位模式在无符号表示中斗变成了正数。
- 几乎所有机器都是以补码形式来表示有符号整数。C语言中没有要求用补码形式表示有符号整数，但是在Java中明确要求用补码表示整数，单字节数据类型称为byte。这些都是为了保证Java在任何机器上运行都能表现一致。

### 原码、反码、补码

![有符号数的其他表示方式(1)](https://ws2.sinaimg.cn/large/006tNc79gy1fzh2w21puaj30ni0bmk7w.jpg)

![有符号数的其他表示方法(2)](https://ws4.sinaimg.cn/large/006tNc79gy1fzh2wucsemj30na046tf4.jpg)

- 注意区别于无符号数，上图列出的都是有符号数的表示方式。即有符号数的表示方式可以有原码、反码、补码三种，而无符号数的表示方式，按照除2取余法即可得到，不存在符号位。
- 原码、反码、补码之间的转换关系，简单来说，就是**除符号位外**，原码按位取反得到反码，反码最低位+1得到补码。
- 用原码或反码表示数字0时，都会存在正负0的问题。但是用补码表示，正负0的值都是唯一的，不存在这个问题。存在正负0的原因是符号位不同导致的。